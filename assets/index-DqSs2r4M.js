(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function t(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?r.credentials="include":e.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(e){if(e.ep)return;e.ep=!0;const r=t(e);fetch(e.href,r)}})();const k="modulepreload",w=function(c){return"/"+c},f={},b=function(n,t,o){let e=Promise.resolve();if(t&&t.length>0){let s=function(a){return Promise.all(a.map(u=>Promise.resolve(u).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),m=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));e=s(t.map(a=>{if(a=w(a),a in f)return;f[a]=!0;const u=a.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${d}`))return;const l=document.createElement("link");if(l.rel=u?"stylesheet":k,u||(l.as="script"),l.crossOrigin="",l.href=a,m&&l.setAttribute("nonce",m),document.head.appendChild(l),u)return new Promise((p,y)=>{l.addEventListener("load",p),l.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${a}`)))})}))}function r(s){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=s,window.dispatchEvent(i),!i.defaultPrevented)throw s}return e.then(s=>{for(const i of s||[])i.status==="rejected"&&r(i.reason);return n().catch(r)})};class E{constructor(){var n;this.tg=(n=window.Telegram)==null?void 0:n.WebApp,this.backendUrl="http://localhost:3000",this.user=null,this.authToken=null}init(){return new Promise((n,t)=>{var r;if(!this.tg)return t(new Error("Aplikasi hanya bisa dibuka di Telegram"));this.tg.ready(),this.tg.expand();const o=this.tg.initData,e=(r=this.tg.initDataUnsafe)==null?void 0:r.user;if(!e)return t(new Error("User Telegram tidak ditemukan"));this.user=e,this.authenticateWithBackend(o).then(n).catch(t)})}async authenticateWithBackend(n){try{const t=await fetch(`${this.backendUrl}/auth/telegram`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({initData:n,user:this.user})});if(!t.ok)throw new Error("Autentikasi gagal");const o=await t.json();return this.authToken=o.token,o}catch(t){throw console.error("Auth error:",t),new Error("Gagal autentikasi ke backend.")}}getAuthHeaders(){return{Authorization:`Bearer ${this.authToken}`,"Content-Type":"application/json"}}hapticFeedback(n="impact"){var t,o;(o=(t=this.tg)==null?void 0:t.HapticFeedback)==null||o.impactOccurred(n)}showMainButton(n,t){var o;(o=this.tg)!=null&&o.MainButton&&(this.tg.MainButton.setText(n),this.tg.MainButton.show(),this.tg.MainButton.onClick(t))}}const T=new E,g=document.getElementById("loading"),h=document.getElementById("error"),P=document.getElementById("game-container");T.init().then(()=>{g.style.display="none",P.style.display="block",b(()=>import("./main-Cb4FFgeR.js"),[]).then(()=>console.log("Game dimuat")).catch(c=>{console.error("Gagal load game:",c),h.innerText="Gagal memuat game.",h.style.display="block"})}).catch(c=>{console.error("Auth gagal:",c),g.style.display="none",h.innerText=c.message,h.style.display="block"});
